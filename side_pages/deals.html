<html>
<head>
   <title>Deals</title>
   <meta name="viewport" content="width=device-width, initial-scale=1">
   <link rel="shortcut icon" type="image/png" href="../App Home/assets/logo/logo_transparent.png">

   <!-- Bootstrap -->
   <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-GLhlTQ8iRABdZLl6O3oVMWSktQOp6b7In1Zl3/Jr59b6EGGoI1aFkw7cmDA6j6gD" crossorigin="anonymous">
   <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.3.0/font/bootstrap-icons.css" rel="stylesheet">
   <!-- Font Awesome Library -->
   <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.1.1/css/all.min.css"/> 

   <!-- Custom CSS -->
   <link rel="stylesheet" href="../App Home/style.css">
<style>
button{cursor:pointer;}
div.deals{position:absolute;
          top:10%;
          left:25%;
          width:800px;
          font-size:100px;
          }
div.update{position:absolute;
           left:40%;
           top:40%;
           z-index:13;
           background-color:white;
           width:20%;
           height:20%;
           visibility:hidden;
           border:1px solid black;}
table{width:80%;
      font-size:25px;
      padding:7px;
      }
#galry{position:absolute;
       left:20%;
       top:20%;
       width:60%;
       height:60%;
       z-index:9;
       background-color:green;
       border:1px solid black;
       border-radius:15px;
       visibility:hidden;}
       
</style>
</head>
<body>

   <header class="bg-dark" data-bs-theme="dark">
      <span id="brand_name">
         <h1>मेरा स्थानीय</h1>
      </span>
      <img src="../App Home/assets/logo/logo.png"  class="img-thumbnail" id="logo" alt="Logo">
      <span id="brand_name">
        <h1>My Local</h1>
      </span>
   </header>
   <nav class="navbar navbar-dark navbar-expand-lg bg-dark fixed" data-bs-theme="dark">
      <div class="container-fluid">
         <a class="navbar-brand d-flex align-items-center justify-content-center flex-column" href="#">
            <span><i class="bi bi-bag-fill"></i></i></span>
            <span>Deals</span>
         </a>
         <button class="navbar-toggler" type="button" data-bs-toggle="offcanvas" data-bs-target="#offcanvasDarkNavbar" aria-controls="offcanvasDarkNavbar">
            <span class="navbar-toggler-icon"></span>
         </button>
         <div class="offcanvas offcanvas-end text-bg-dark" tabindex="-1" id="offcanvasDarkNavbar" aria-labelledby="offcanvasDarkNavbarLabel">
            <div class="offcanvas-header">
               <h5 class="offcanvas-title" id="offcanvasDarkNavbarLabel">Deals</h5>
               <button type="button" class="btn-close btn-close-white" data-bs-dismiss="offcanvas" aria-label="Close"></button>
            </div>
            <div class="offcanvas-body">
               <ul class="navbar-nav justify-content-around flex-grow-1 pe-3">
                  <li class="nav-item">
                     <a class="nav-link d-flex align-items-center justify-content-center flex-column" href="../index.html" role="button">
                        <span><i class="bi bi-house-door-fill"></i></span> 
                        <span>Home</span> 
                     </a>
                  </li>
                  <li class="nav-item">
                     <a class="nav-link d-flex align-items-center justify-content-center flex-column" href="profile.html" role="button">
                        <span><i class="bi bi-people-fill"></i></span> 
                        <span>People</span> 
                     </a>
                  </li>
                  <li class="nav-item">
                     <a class="nav-link d-flex align-items-center justify-content-center flex-column" href="hiring.html" role="button">
                        <span><i class="bi bi-person-badge-fill"></i></span>
                        <span>Hiring</span>
                     </a>
                  </li>
                  <li class="nav-item">
                     <a class="nav-link d-flex align-items-center justify-content-center flex-column" href="page.html" role="button">
                        <span><i class="bi bi-person-circle"></i></span>
                        <span>Profile</span>
                     </a>
                  </li>
                  <li class="nav-item">
                     <a class="nav-link d-flex align-items-center justify-content-center flex-column" href="login.html" role="button">
                        <span><i class="bi bi-person-fill"></i></span>
                        <span>Login</span>
                     </a>
                  </li>
                  <li class="nav-item">
                     <a class="nav-link d-flex align-items-center justify-content-center flex-column" href="sarthak signup.html" role="button">
                        <span><i class="bi bi-person-plus-fill"></i></span>
                        <span>Sign Up</span>
                     </a>
                  </li>
                  <li class="nav-item">
                     <a class="nav-link d-flex align-items-center justify-content-center flex-column" role="button" onclick="logout()">
                        <span><i class="bi bi-power"></i></span>
                        <span>Logout</span>
                     </a>
                  </li>
               </ul>
            </div>
         </div>        
      </div>
   </nav>
   <section class="container-fluid" id="main_content">
      <div id="deal" class="deals"></div>
      <div id="galry">
         <span onclick="clos()" class="close" style="cursor:pointer; font-size:35px;">&times;</span>
         <table>
           <tr>
             <td colspan="2"><img id="pic1" width="500px" height="200px"></td>
           </tr>
           <tr>
             <td><img id="pic2" width="100px" height="100px"></td>
             <td><img id="pic3"  width="100px" height="100px"></td>
             <td><img id="pic4" width="100px" height="100px"></td>
             <td><img id="pic5" width="100px" height="100px"></td>
           </tr>
         </table> 

      </div>
      <div id="update" class="update">
         <select id="wstatus" style="font-size:25px;">
            <option value="In Progress">In Progress</option>
            <option value="Completed">Completed</option>
            <option value="cancelled">Cancelled</option>
         </select>
         <div id="btn">
            <button style="position:absolute; left:40%; top:70%;" onclick="clos()">Update</button>
         </div>
      </div>
   </section>
   <footer  id="footer" class="bg-dark row row-cols-1 row-cols-sm-2 row-cols-md-5 py-5 border-top d-flex justify-content-center" data-bs-theme="dark">
      <div class="container container-fluid row align-items-center">
         <div id="footer_icons" class="row align-items-center col-12">
            <div class="col-3"><a href="#" target="blank"><i class="fa-brands fa-twitter"></i></a></div>
            <div class="col-3"><a href="#" target="blank"><i class="fa-brands fa-facebook"></i></a></div>
            <div class="col-3"><a href="#" target="blank"><i class="fa-brands fa-linkedin"></i></a></div>
            <div class="col-3"><a href="#"><i class="fa-brands fa-youtube"></i></a></div>
         </div>
         <div class="col-12 mb-12">
            <h5>Quick Links</h5>
            <ul class="nav flex-column" id="footer_links">
               <li class="nav-item mb-2"><a href="../index.html" class="nav-link p-0 text-muted">Home</a></li>
               <li class="nav-item mb-2"><a href="profile.html" class="nav-link p-0 text-muted">People</a></li>
               <li class="nav-item mb-2"><a href="hiring.html" class="nav-link p-0 text-muted">Hiring</a></li>
               <li class="nav-item mb-2"><a href="#" class="nav-link p-0 text-muted">Contact Us</a></li>
               <li class="nav-item mb-2"><a href="#" class="nav-link p-0 text-muted">Site Map</a></li>
            </ul>
         </div>
      </div>
   </footer>
   <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js" integrity="sha384-w76AqPfDkMBDXo30jS1Sgez6pr3x5MlQ1ZAGC+nuZB+EYdgRZgiwxhTBTkF7CXvN" crossorigin="anonymous"></script>
   <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js" integrity="sha384-DfXdz2htPH0lsSSs5nCTpuj/zy4C+OGpamoFVy38MVBnE+IbbVYUew+OrCXaRkfj" crossorigin="anonymous"></script>
   <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.1/dist/umd/popper.min.js" integrity="sha384-9/reFTGAW83EW2RDu2S0VKaIzap3H66lZH81PoYlFhbGU+6BZp6G7niu735Sk7lN" crossorigin="anonymous"></script>
   <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/js/bootstrap.min.js" integrity="sha384-w1Q4orYjBQndcko6MimVbzY0tgp4pWB4lZ7lr30WKz0vr/aWKhXdBNmNb5D92v7s" crossorigin="anonymous"></script>
<script>
count=1
trcount=1
function x(){
y="dealing"+count
a=document.createElement("table")
a.id="dealing"+count
a.style.border="1px solid black"
document.getElementById("deal").appendChild(a)
count+=1
b=document.createElement("tr")
b.id="image"+trcount
document.getElementById(y).appendChild(b)
c=document.createElement("td")
c.rowSpan="7"
d=document.createElement("img")
d.src=img1
d.onclick = function() { gallery() };
d.style.width="220px"
d.style.height="270px";
c.appendChild(d)
b.appendChild(c)
e=document.createElement("tr")
e.id="nam"+trcount
document.getElementById(y).appendChild(e)
f=document.createElement("td")
g=document.createElement("h3")
g.innerText=hirer
f.appendChild(g)
e.appendChild(f)
ha=document.createElement("tr")
ha.id="type"+trcount
document.getElementById(y).appendChild(ha)
h=document.createElement("td")
i=document.createElement("p")
i.innerText=type
h.appendChild(i)
ha.appendChild(h)
j=document.createElement("tr")
j.id="desc"+trcount
document.getElementById(y).appendChild(j)
k=document.createElement("td")
l=document.createTextNode(desc)
k.appendChild(l)
j.appendChild(k)
m=document.createElement("tr")
m.id="datetime"+trcount
document.getElementById(y).appendChild(m)
n=document.createElement("td")
o=document.createTextNode(dat)
oa=document.createTextNode(" ")
ob=document.createTextNode(tim)
n.appendChild(o)
n.appendChild(oa)
n.appendChild(ob)
m.appendChild(n)
p=document.createElement("tr")
p.id="lction"+trcount
document.getElementById(y).appendChild(p)
q=document.createElement("td")
r=document.createTextNode(lction)
q.appendChild(r)
p.appendChild(q)
trcount+=1
s=document.createElement("br")
document.getElementById("deal").appendChild(s)
t=document.createElement("td")
u=document.createElement("button")
u.onclick = function() { stats(); };
ua=document.createTextNode("Update Status")
u.appendChild(ua)
t.appendChild(u)
p.appendChild(t)
v=document.createElement("tr")
v.id="status"+trcount
document.getElementById(y).appendChild(v)
w=document.createElement("td")
z=document.createTextNode(status)
w.appendChild(z)
v.appendChild(w)
}

function gallery(){
   document.getElementById("galry").style.visibility="visible"
   document.body.style.backgroundColor="grey"
}
function clos(){
   document.getElementById("galry").style.visibility="hidden"
   document.getElementById("update").style.visibility="hidden"
   document.body.style.backgroundColor="white"
}
function stats(){
   
   document.getElementById("update").style.visibility="visible"
}
</script>

<script src="https://www.gstatic.com/firebasejs/9.17.1/firebase-app.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/firebase/7.14.1-0/firebase.js"></script>
<script>
 const firebaseConfig = {
    apiKey: "AIzaSyB627a-ThWusMYiaPooK8R57UDkD2OdAp4",
    authDomain: "gsolution-240c6.firebaseapp.com",
    databaseURL: "https://gsolution-240c6-default-rtdb.firebaseio.com",
    projectId: "gsolution-240c6",
    storageBucket: "gsolution-240c6.appspot.com",
    messagingSenderId: "734513557996",
    appId: "1:734513557996:web:fe84d9214593159b1950c9"
  };
firebase.initializeApp(firebaseConfig);
q=JSON.parse(window.localStorage.getItem('login'));
countnum=0
countx=0;
var dataa=[]
datacount=1
function retrieved(){
/*f=document.getElementById("nam").innerText*/
var ref = firebase.database().ref('/hiring/'+q[0][1]+q[0][0]);
datacount+=1
ref.on("value", function(snapshot) {
   console.log(snapshot.val().hirername);
   hirer=snapshot.val().hirername
   type=snapshot.val().worktype
   dat=snapshot.val().date
   tim=snapshot.val().time
   desc=snapshot.val().description
   lction=snapshot.val().location
   img1=snapshot.val().image1
   img2=snapshot.val().image2
   img3=snapshot.val().image3
   img4=snapshot.val().image4
   img5=snapshot.val().image5
   status=snapshot.val().status
   x()
   galerview()
}, function (error) {
   console.log("Error: " + error.code);
});
}


/*f=document.getElementById("nam").innerText*/
var ref = firebase.database().ref('/hiring/');
ref.on('child_added', function(snapshot) {
   countnum++;
  // how do I know if this is the last child? i.e. the count is complete?
});

ref.on('value', function(snapshot) {
countx+=countnum
counter()
});
function counter(){
for(; datacount<=countx;){
retrieved()}}

function galerview(){
    document.getElementById("pic1").src=img1
    document.getElementById("pic2").src=img2
    document.getElementById("pic3").src=img3
    document.getElementById("pic4").src=img4
    document.getElementById("pic5").src=img5
}
</script>

<script>
qa=JSON.parse(window.localStorage.getItem('login'))
 f=qa[0][1]+qa[0][0]
 var a="/hiring/"+f
 var messagesRef = firebase.database()
            .ref(a);
        document.getElementById('btn')
            .addEventListener('click', submitForm);
        function submitForm(e) {
            
            e.preventDefault();
            // Get values
             var status=document.getElementById("wstatus").value;
           
            console.log(status);
            saveMessage(status);

           }            
        // Function to get form values
        function getInputVal(id) {
            return document.getElementById(id).value;
        }
        // Save message to firebase
        function saveMessage(status) {
             
             /*var newMessageRef = messagesRef.push();*/
            messagesRef.update({
                status:status,
            });}

</script>

   <!-- Custom Scripts -->
   <!-- Login Status -->
   <script src="../login_status.js"></script>
</body>
</html>
