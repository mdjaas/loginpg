<html>
<head>
   <title>Login </title>
   <meta name="viewport" content="width=device-width, initial-scale=1">
   <link rel="shortcut icon" type="image/png" href="../App Home/assets/logo/logo_transparent.png">

   <!-- Bootstrap -->
   <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-GLhlTQ8iRABdZLl6O3oVMWSktQOp6b7In1Zl3/Jr59b6EGGoI1aFkw7cmDA6j6gD" crossorigin="anonymous">
   <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.3.0/font/bootstrap-icons.css" rel="stylesheet">
   <!-- Font Awesome Library -->
   <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.1.1/css/all.min.css"/> 

   <!-- Custom CSS -->
   <link rel="stylesheet" href="../App Home/style.css">
   <!-- Fontawesome Library -->
   <link rel="stylesheet" href="../style.css">
</head>
<body>

   <header class="bg-dark" data-bs-theme="dark">
      <span id="brand_name">
         <h1>मेरा स्थानीय</h1>
      </span>
      <img src="../App Home/assets/logo/logo.png"  class="img-thumbnail" id="logo" alt="Logo">
      <span id="brand_name">
        <h1>My Local</h1>
      </span>
   </header>
   <nav class="navbar navbar-dark navbar-expand-lg bg-dark fixed" data-bs-theme="dark">
      <div class="container-fluid">
         <a class="navbar-brand d-flex align-items-center justify-content-center flex-column" id="signup_nav" href="#">
            <span><i class="bi bi-person-plus-fill"></i></span>
            <span>Sign Up</span>
         </a>
         <button class="navbar-toggler" type="button" data-bs-toggle="offcanvas" data-bs-target="#offcanvasDarkNavbar" aria-controls="offcanvasDarkNavbar">
            <span class="navbar-toggler-icon"></span>
         </button>
         <div class="offcanvas offcanvas-end text-bg-dark" tabindex="-1" id="offcanvasDarkNavbar" aria-labelledby="offcanvasDarkNavbarLabel">
            <div class="offcanvas-header">
               <h5 class="offcanvas-title" id="offcanvasDarkNavbarLabel">Sign Up</h5>
               <button type="button" class="btn-close btn-close-white" data-bs-dismiss="offcanvas" aria-label="Close"></button>
            </div>
            <div class="offcanvas-body">
               <ul class="navbar-nav justify-content-around flex-grow-1 pe-3">
                  <li class="nav-item" id="home_nav">
                     <a class="nav-link d-flex align-items-center justify-content-center flex-column" href="../index.html" role="button">
                        <span><i class="bi bi-house-door-fill"></i></span> 
                        <span>Home</span> 
                     </a>
                  </li>
                  <li class="nav-item" id="deals_nav">
                     <a class="nav-link d-flex align-items-center justify-content-center flex-column" href="deals.html" role="button">
                        <span><i class="bi bi-bag-fill"></i></i></span>
                        <span>Deals</span>
                     </a>
                  </li>
                  <li class="nav-item" id="people_nav">
                     <a class="nav-link d-flex align-items-center justify-content-center flex-column" href="profile.html" role="button">
                        <span><i class="bi bi-people-fill"></i></span> 
                        <span>People</span> 
                     </a>
                  </li>
                  <li class="nav-item" id="hiring_nav">
                     <a class="nav-link d-flex align-items-center justify-content-center flex-column" href="hiring.html" role="button">
                        <span><i class="bi bi-person-badge-fill"></i></span>
                        <span>Hiring</span>
                     </a>
                  </li>
                  <li class="nav-item" id="profile_nav">
                     <a class="nav-link d-flex align-items-center justify-content-center flex-column" href="page.html" role="button">
                        <span><i class="bi bi-person-circle"></i></span>
                        <span>Profile</span>
                     </a>
                  </li>
                  <li class="nav-item" id="login_nav">
                     <a class="nav-link d-flex align-items-center justify-content-center flex-column" href="login.html" role="button">
                        <span><i class="bi bi-person-fill"></i></span>
                        <span>Login</span>
                     </a>
                  </li>
                  <li class="nav-item" id="logout_nav">
                     <a class="nav-link d-flex align-items-center justify-content-center flex-column" role="button" onclick="logout()">
                        <span><i class="bi bi-power"></i></span>
                        <span>Logout</span>
                     </a>
                  </li>
               </ul>
            </div>
         </div>        
      </div>
   </nav>

   <!-- Sarthak's Stepper From -->
   <section class="container-fluid" id="main_content">
       <form id="signupnow" action="" method="post">
         <div class="box">
            <h2>Step 1</h2>
            <div class="inputBox">
               <br>
               <input type="checkbox" id="nwork" name="natureOfWork" value="plumber">
               <span>Plumber</span>
               <input type="checkbox" id="nwork" name="natureOfWork" value="housekeeper">
               <span>Housekeeper</span>
               <br>
               <input type="checkbox" id="nwork" name="natureOfWork" value="Barber">
               <span>Barber</span>
               <input type="checkbox" id="nwork" name="natureOfWork" value="electrician">
               <span>Electrician</span>
               <label>Nature of Work</label>
            </div>
            <div class="inputBox">
               <input type="text" id="fname" name="first_name" required>
               <label>First Name*</label>
            </div>
            <div class="inputBox">
               <input type="text" id="sname" name="last_name" required>
               <label>Last Name*</label>
            </div>
            <div class="buttonSection" id="firstButtonSection">
               <button type="button" class="nextButton">Next</button>
            </div>
         </div>
         <div class="box">
            <h2>Step 2</h2>
            <div class="inputBox">
               <select name="user_type" id="user_type">
                  <option value="employee">Employee</option>
                  <option value="employer">Employer</option>
               </select>
               <label>Select type</label>
            </div>
            <div class="inputBox">
               <input type="date" id="dob" name="dob" required>
               <label>Date of Birth (dd/mm/yyyy)*</label>
            </div>
            <div class="inputBox">
               <input type="text" id="fathername" name="father_name" required>
               <label>Father's Name*</label>
            </div>
            <div class="buttonSection">
               <button type="button" class="previousButton">Previous</button>
               <button type="button" class="nextButton">Next</button>
            </div>
         </div>
         <div class="box">
            <h2>Step 3</h2>
            <div class="inputbox">
               <select id="country" name="country" class="form-control">
                  <option value="India">India</option>

               </select>
              <label for="country">Select Country</label>
            </div>
            <div class="inputBox">
               <input type="text" id="city" name="city" required>
               <label>City*</label>
            </div>
            <div class="inputBox">
               <input type="text" id="pincode" name="pin_code" required>
               <label>Postal Code*</label>
            </div>      
            <div class="buttonSection">
               <button type="button" class="previousButton">Previous</button>
               <button type="button" class="nextButton">Next</button>
            </div>
         </div>
         <div class="box">
            <h2>Step 4</h2>
               <div class="inputBox">
                  <select class="form-select" id="language" name="language">
                     <option value="en">English</option>
                     <option value="hi">Hindi - हिन्दी</option>
                  </select>
                  <label>Preferred Language</label>
               </div>
               <div class="inputBox">
                  <input type="tel" id="ph" name="phone" required>
                  <label>Mobile Number* (with country code)</label>
               </div>
               <div class="inputBox">
                  <input type="tel" id="altph" name="alt_phone" required>
                  <label>Alternate Mobile Number* (with country code)</label>
               </div>
            <div class="buttonSection">
               <button type="button" class="previousButton">Previous</button>
               <button type="button" class="nextButton">Next</button>
            </div>
         </div>
         <div class="box">
            <h2>Step 5</h2>
               <div class="inputBox">
                  <input id="username" onchange="log()" type="text" name="username" required>
                  <label>Choose a Username*</label>
               </div>
               <div class="inputBox">
                  <input type="password" id="password" name="password" required>
                  <label>Create a Password*</label>
               </div>
               <div class="inputBox">
                  <input type="password" id="password" name="password" required>
                  <label>Confirm Password</label>
               </div>
            <div class="buttonSection">
               <button type="button" class="previousButton">Previous</button>
               <button type="button" class="nextButton">Next</button>
            </div>
         </div>
         <div class="box">
            <h2>Are you sure you want to Submit?</h2>
            <div id="sbmit" class="buttonSection">
               <button type="button" class="previousButton">Go Back</button>
              <div id="creat">
               <input type="submit" onclick="store()" class="nextButton" id="submitButton">
              </div>
            </div>
         </div>
         <div class="box">
            <h2>Success <i class="fas fa-check-circle"></i></h2>
         </div>
      </form>
      <script type="text/javascript" src="../Stepper_Form.js"></script>
   </section>
 
   <footer  id="footer" class="bg-dark row row-cols-1 row-cols-sm-2 row-cols-md-5 py-5 border-top d-flex justify-content-center" data-bs-theme="dark">
      <div class="container container-fluid row align-items-center">
         <div id="footer_icons" class="row align-items-center col-12">
            <div class="col-3"><a href="#" target="blank"><i class="fa-brands fa-twitter"></i></a></div>
            <div class="col-3"><a href="#" target="blank"><i class="fa-brands fa-facebook"></i></a></div>
            <div class="col-3"><a href="#" target="blank"><i class="fa-brands fa-linkedin"></i></a></div>
            <div class="col-3"><a href="#"><i class="fa-brands fa-youtube"></i></a></div>
         </div>
         <div class="col-12 mb-12">
            <h5>Quick Links</h5>
            <ul class="nav flex-column" id="footer_links">
               <li class="nav-item mb-2"><a href="../index.html" class="nav-link p-0 text-muted">Home</a></li>
               <li class="nav-item mb-2"><a href="page.html" class="nav-link p-0 text-muted">People</a></li>
               <li class="nav-item mb-2"><a href="hiring.html" class="nav-link p-0 text-muted">Hiring</a></li>
               <li class="nav-item mb-2"><a href="#" class="nav-link p-0 text-muted">Contact Us</a></li>
               <li class="nav-item mb-2"><a href="#" class="nav-link p-0 text-muted">Site Map</a></li>
            </ul>
         </div>
      </div>
   </footer>
   <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js" integrity="sha384-w76AqPfDkMBDXo30jS1Sgez6pr3x5MlQ1ZAGC+nuZB+EYdgRZgiwxhTBTkF7CXvN" crossorigin="anonymous"></script>
   <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js" integrity="sha384-DfXdz2htPH0lsSSs5nCTpuj/zy4C+OGpamoFVy38MVBnE+IbbVYUew+OrCXaRkfj" crossorigin="anonymous"></script>
   <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.1/dist/umd/popper.min.js" integrity="sha384-9/reFTGAW83EW2RDu2S0VKaIzap3H66lZH81PoYlFhbGU+6BZp6G7niu735Sk7lN" crossorigin="anonymous"></script>
   <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/js/bootstrap.min.js" integrity="sha384-w1Q4orYjBQndcko6MimVbzY0tgp4pWB4lZ7lr30WKz0vr/aWKhXdBNmNb5D92v7s" crossorigin="anonymous"></script>

   <script src="https://www.gstatic.com/firebasejs/9.17.1/firebase-app.js"></script>
   <script src="https://cdnjs.cloudflare.com/ajax/libs/firebase/7.14.1-0/firebase.js"></script>

<script>
const firebaseConfig = {
  apiKey: "AIzaSyB627a-ThWusMYiaPooK8R57UDkD2OdAp4",
  authDomain: "gsolution-240c6.firebaseapp.com",
  databaseURL: "https://gsolution-240c6-default-rtdb.firebaseio.com",
  projectId: "gsolution-240c6",
  storageBucket: "gsolution-240c6.appspot.com",
  messagingSenderId: "734513557996",
  appId: "1:734513557996:web:fe84d9214593159b1950c9"
};

firebase.initializeApp(firebaseConfig);
 count=1
function store(){
 var a="/credential/credential"+count
 var messagesRef = firebase.database()
            .ref(a);
        document.getElementById('signupnow')
            .addEventListener('submit', submitForm);
        function submitForm(e) {
         
            e.preventDefault();
            // Get values
             var uname=document.getElementById("username").value
             var pwd= document.getElementById("password").value;
             var fname= document.getElementById("fname").value
             var sname= document.getElementById("sname").value
             var utype= document.getElementById("user_type").value
             var father= document.getElementById("fathername").value
             var dob= document.getElementById("dob").value
             var country= document.getElementById("country").value
             var city= document.getElementById("city").value
             var pin= document.getElementById("pincode").value
             var language= document.getElementById("language").value
             var phone= document.getElementById("ph").value
             var altphone= document.getElementById("altph").value
             var workcity=""
             var worktype=document.getElementById("nwork").value
            console.log(uname);
            messagesRef.on("value", function(snapshot){
             if(snapshot.exists()){
           
             }
             else{
            saveMessage(uname, pwd, fname, sname, utype, father, dob, country,city, pin, language, phone, altphone,worktype,workcity);
            }})}
                     
        // Function to get form values
        function getInputVal(id) {
            return document.getElementById(id).value;
        }
        // Save message to firebase
        function saveMessage(uname, pwd, fname, sname, utype, father, dob, country,city, pin, language, phone, altphone,worktype,workcity) {
             
             /*var newMessageRef = messagesRef.push();*/
            messagesRef.update({
                username:uname,
                password:pwd,
                firstname:fname,
                secondname:sname,
                usertype:utype,
                father:father,
                dob:dob,
                country:country,
                city:city,
                pin:pin,
                language:language,
                phone:phone,
                altphone:altphone, 
                worktype:worktype,
                workcity:workcity,
            });
        }
count+=1}
</script>

<script>

countnum=0
countx=0;
var dataa=[]
datacount=1
function log(){
function retrieved(){
/*f=document.getElementById("nam").innerText*/
var ref = firebase.database().ref('/credential/credential'+datacount);
datacount+=1
ref.on("value", function(snapshot) {
   console.log(snapshot.val().username);
   user=snapshot.val().username
   login()
}, function (error) {
   console.log("Error: " + error.code);
});
}


/*f=document.getElementById("nam").innerText*/
var ref = firebase.database().ref('/credential/');
ref.on('child_added', function(snapshot) {
   countnum++;
  // how do I know if this is the last child? i.e. the count is complete?
});

ref.on('value', function(snapshot) {
countx+=countnum
counter()

});
function counter(){
for(; datacount<=countx;){
retrieved()}}
}

function login(){
    
    if(document.getElementById("username").value==user){
         alert("Username already taken")
        if(datacount==countx+1){
           datacount=1
           countx=0
           countnum=0}
         }
    else{
          if(datacount==countx+1){
           count=datacount
           datacount=1
           countx=0
           countnum=0}}
}
</script>

   <!-- Custom Scripts -->
   <!-- Login Status -->
   <script src="../login_status.js"></script>
</body>
</html>
